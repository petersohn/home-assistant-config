global_modules:
  - aggregator

wind_direction_yr:
  class: WindDirection
  module: wind_direction
  entity: sensor.yr_wind_direction

wind_direction:
  class: WindDirection
  module: wind_direction
  entity: sensor.wind_direction

wind_direction_average_icon:
  class: WindDirection
  module: wind_direction
  entity: sensor.wind_direction_average

heating_pump:
  class: TemperatureController
  module: temperature_controller
  target:
    min_temperature: 0
    min_target: 65
    max_temperature: 10
    max_target: 55
  minimum: 30
  low_mode_start: 15
  low_mode_time: 5
  sensor: sensor.temperature_furnace_wood
  outside_sensor: sensor.temperature_outside
  availability: binary_sensor.furnace_temperature_available
  switch: switch.heating_pump

auto_switch_light_driveway:
  module: auto_switch
  class: AutoSwitch
  target: switch.light_driveway
  switch: input_select.light_driveway
  reentrant: true

sun_enabler_night:
    module: enabler
    class: ValueEnabler
    entity: binary_sensor.night
    value: 'on'

wind_short_term:
  module: history
  class: HistoryManager
  entity: sensor.wind_strength

wind_direction_short_term:
  module: history
  class: HistoryManager
  entity: sensor.wind_direction
  refresh_interval:
    seconds: 10

wind_disabler:
    module: enabler
    class: HistoryEnabler
    dependencies: wind_short_term
    manager: wind_short_term
    aggregator: max
    max: 40
    interval:
      minutes: 10
    default: 0

wind_direction_average:
  module: history
  class: AggregatedValue
  global_dependencies: aggregator
  dependencies: wind_direction_short_term
  manager: wind_direction_short_term
  target: sensor.wind_direction_average
  interval:
    minutes: 10
  aggregator: anglemean
  attributes:
    unit_of_measurement: "°"
    friendly_name: "Szélirány"

driveway_motion_sensor:
  class: MotionSensor
  module: motion_sensor
  dependencies:
    - sun_enabler_night
    - wind_disabler
    - auto_switch_light_driveway
  sensors:
    - binary_sensor.motion_sensor_driveway_upper
    - binary_sensor.motion_sensor_driveway_lower
  targets:
    - auto_switch_light_driveway
  enablers:
    - sun_enabler_night
    - wind_disabler
  time: 2

christmas_light_switch:
  module: auto_switch
  class: AutoSwitch
  target: switch.light_christmas_front
  switch: input_select.light_christmas

well_auto_switch:
  module: auto_switch
  class: AutoSwitch
  target: switch.well
  switch: input_select.well

christmas_lights_enabler:
    module: enabler
    class: DateEnabler
    begin: 11-15
    end: 02-28

christmas_light_switcher:
    class: EnabledSwitch
    module: enabled_switch
    dependencies:
        - christmas_light_switch
        - christmas_lights_enabler
        - sun_enabler_night
    global_dependencies:
        - auto_switch
        - enabler
    enablers:
        - christmas_lights_enabler
        - sun_enabler_night
    targets:
        - christmas_light_switch
        - well_auto_switch
