homeassistant:
  # Name of the location where Home Assistant is running
  name: Home
  # Location required to calculate the time the sun rises and sets
  latitude: !secret latitude
  longitude: !secret longitude
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: !secret elevation
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/Budapest
  country: HU
  customize: !include customize.yaml

# Enables the frontend
frontend:

# Enables configuration UI
config:

homeassistant_alerts:

http:
    use_x_forwarded_for: true
    trusted_proxies:
      - 127.0.0.1
      - ::1

lovelace:
  mode: yaml

mobile_app:

system_health:

sun:

zone:
  - name: Home
    latitude: !secret latitude
    longitude: !secret longitude
    radius: 150
    icon: mdi:home

recorder:
  auto_purge: true
  purge_keep_days: 14
  db_url: !secret db_location

# Enables support for tracking state changes over time.
history:
  exclude:
    domains:
      - group

# View all events in a logbook
logbook:
  exclude:
    domains:
      - group

alert: !include alert.yaml
automation: !include automations.yaml
input_boolean: !include input_boolean.yaml
input_select: !include input_select.yaml
mqtt: !include mqtt.yaml
script: !include script.yaml

sensor:
  - platform: time_date
    display_options:
      - 'date'
      - 'time'
      - 'date_time'
  - platform: command_line
    name: cpu_temperature
    command: "cat /sys/class/thermal/thermal_zone0/temp"
    # If errors occur, make sure configuration file is encoded as UTF-8
    unit_of_measurement: "°C"
    value_template: "{{ value | multiply(0.001) }}"
    scan_interval: 10

binary_sensor:
  - platform: ping
    host: !secret router_address
    name: network_available
  - platform: ping
    host: !secret desktop_address
    name: desktop_available
  - platform: ping
    host: google.com
    name: internet_available
  - platform: ping
    host: !secret gateway_address
    name: gateway_available
  - platform: command_line
    command: 'timeout 2 nc localhost 6131 </dev/null && echo ON || echo OFF'
    name: ssh_tunnel_available

  - platform: tod
    name: Night
    after: sunset
    after_offset: 00:10
    before: sunrise
    before_offset: -00:10

climate:
  - platform: generic_thermostat
    name: heater
    heater: switch.heater
    target_sensor: sensor.heater_check2
    min_temp: 10
    max_temp: 25
    ac_mode: false
    cold_tolerance: 1
    hot_tolerance: 0
    min_cycle_duration:
      minutes: 5
    keep_alive:
      seconds: 15
    initial_hvac_mode: "off"
    away_temp: 10
    precision: 0.5

# media_player:
#   - platform: clementine
#     name: desktop
#     host: !secret desktop_address

template:
  - binary_sensor:
    - name: presence_home
      state: >
        {{ is_state('input_select.presence_mode', 'home') }}
  - binary_sensor:
    - name: presence_sleep
      state: >
        {{ is_state('input_select.presence_mode', 'sleep') }}
  - binary_sensor:
    - name: presence_away
      state: >
        {{ is_state('input_select.presence_mode', 'away') }}

  - binary_sensor:
    - name: climate_off
      state: >
        {{ is_state('input_select.climate_mode', 'off') }}
  - binary_sensor:
    - name: climate_auto
      state: >
        {{ is_state('input_select.climate_mode', 'auto') }}
  - binary_sensor:
    - name: climate_heat_up
      state: >
        {{ is_state('input_select.climate_mode', 'heat_up') }}
  - binary_sensor:
    - name: climate_keep_warm
      state: >
        {{ is_state('input_select.climate_mode', 'keep_warm') }}


input_number:
  sprinkler_cellar_day:
    name: "Pince locsolás napja"
    min: 0
    max: 28
    icon: mdi:calendar
  heater_temperature_normal:
    name: "Fűtés hőmérséklet"
    min: 10
    max: 25
    icon: mdi:fireplace-off
  heater_temperature_wood_heating:
    name: "Fűtés hőmérséklet fa fűtésnél"
    min: 10
    max: 25
    icon: mdi:fireplace

mqtt_statestream:
  base_topic: home
  include:
    domains:
      - input_select
      - sensor
      - binary_sensor

influxdb:
  host: localhost
  port: 8086
  username: !secret influxdb_username
  password: !secret influxdb_password
  database: !secret influxdb_database

telegram_bot:
  - platform: polling
    api_key: !secret telegram_api_key
    allowed_chat_ids:
      - !secret telegram_chat_id

notify:
  - name: telegram_alert
    platform: telegram
    chat_id: !secret telegram_chat_id
