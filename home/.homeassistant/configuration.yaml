homeassistant:
  # Name of the location where Home Assistant is running
  name: Home
  # Location required to calculate the time the sun rises and sets
  latitude: !secret latitude
  longitude: !secret longitude
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: !secret elevation
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/Budapest
  customize: !include customize.yaml

# Enables the frontend
frontend:

# Enables configuration UI
config:

http:
  api_password: !secret http_password
  # Uncomment this to add a password (recommended!)
  # api_password: PASSWORD
  # Uncomment this if you are using SSL or running in Docker etc
  # base_url: example.duckdns.org:8123

# Checks for available updates
# Note: This component will send some information about your system to
# the developers to assist with development of Home Assistant.
# For more information, please see:
# https://home-assistant.io/blog/2016/10/25/explaining-the-updater/
updater:

# Discover some devices automatically
discovery:

# Allows you to issue voice commands from the frontend in enabled browsers
conversation:

recorder:
  purge_interval: 1
  purge_keep_days: 30

# Enables support for tracking state changes over time.
history:
  exclude:
    domains:
      - group

# View all events in a logbook
logbook:
  exclude:
    entities:
      - sensor.yr_symbol
    domains:
      - group

# Track the sun
sun:

mqtt:
  broker: 127.0.0.1
  port: 1883
  client_id: home-assistant-1
  username: !secret mosquitto_username
  password: !secret mosquitto_pasword

sensor:
  - platform: yr
    state_topic: yr
    monitored_conditions:
      - temperature
      - symbol
      - precipitation
      - windSpeed
      - windDirection
      - humidity
      - cloudiness
  - platform: moon
  - platform: mqtt
    state_topic: home/sensors/temperature/outside
    unit_of_measurement: "°C"
    name: temperature_outside
  - platform: mqtt
    state_topic: home/sensors/humidity/outside
    unit_of_measurement: "%"
    name: humidity_outside
  - platform: mqtt
    state_topic: home/sensors/temperature/furnace_room
    unit_of_measurement: "°C"
    name: temperature_furnace_room
  - platform: mqtt
    state_topic: home/sensors/humidity/furnace_room
    unit_of_measurement: "%"
    name: humidity_furnace_room
  - platform: mqtt
    state_topic: home/sensors/temperature/living_room/lower
    unit_of_measurement: "°C"
    name: temperature_living_room_lower
  - platform: mqtt
    state_topic: home/sensors/humidity/living_room/lower
    unit_of_measurement: "%"
    name: humidity_living_room_lower
  - platform: mqtt
    state_topic: home/sensors/temperature/living_room/upper
    unit_of_measurement: "°C"
    name: temperature_living_room_upper
  - platform: mqtt
    state_topic: home/sensors/humidity/living_room/upper
    unit_of_measurement: "%"
    name: humidity_living_room_upper
  - platform: mqtt
    state_topic: home/sensors/temperature/bedroom/lower
    unit_of_measurement: "°C"
    name: temperature_bedroom_lower
  - platform: mqtt
    state_topic: home/sensors/humidity/bedroom/lower
    unit_of_measurement: "%"
    name: humidity_bedroom_lower
  - platform: mqtt
    state_topic: home/sensors/temperature/bedroom/upper
    unit_of_measurement: "°C"
    name: temperature_bedroom_upper
  - platform: mqtt
    state_topic: home/sensors/humidity/bedroom/upper
    unit_of_measurement: "%"
    name: humidity_bedroom_upper
  - platform: mqtt
    state_topic: home/sensors/temperature/furnace/gas
    unit_of_measurement: "°C"
    name: temperature_furnace_gas
  - platform: mqtt
    state_topic: home/sensors/temperature/furnace/wood
    unit_of_measurement: "°C"
    name: temperature_furnace_wood

  - platform: mqtt
    state_topic: home/devices/well_controller/availability
    name: well_controller_free_memory
    value_template: '{{ value_json.freeMemory }}'
    unit_of_measurement: "b"
  - platform: mqtt
    state_topic: home/devices/well_controller/availability
    name: well_controller_uptime
    value_template: '{{ value_json.uptime }}'
    unit_of_measurement: "ms"
  - platform: mqtt
    state_topic: home/devices/furnaceTemperature/availability
    name: furnace_temperature_free_memory
    value_template: '{{ value_json.freeMemory }}'
    unit_of_measurement: "b"
  - platform: mqtt
    state_topic: home/devices/furnaceTemperature/availability
    name: furnace_temperature_uptime
    value_template: '{{ value_json.uptime }}'
    unit_of_measurement: "ms"
  - platform: mqtt
    state_topic: home/devices/motion_sensor_driveway_lower/availability
    name: motion_sensor_driveway_lower_free_memory
    value_template: '{{ value_json.freeMemory }}'
    unit_of_measurement: "b"
  - platform: mqtt
    state_topic: home/devices/motion_sensor_driveway_lower/availability
    name: motion_sensor_driveway_lower_uptime
    value_template: '{{ value_json.uptime }}'
    unit_of_measurement: "ms"
  - platform: mqtt
    state_topic: home/devices/motion_sensor_driveway_upper/availability
    name: motion_sensor_driveway_upper_free_memory
    value_template: '{{ value_json.freeMemory }}'
    unit_of_measurement: "b"
  - platform: mqtt
    state_topic: home/devices/motion_sensor_driveway_upper/availability
    name: motion_sensor_driveway_upper_uptime
    value_template: '{{ value_json.uptime }}'
    unit_of_measurement: "ms"
  - platform: mqtt
    state_topic: home/devices/living_room_temperature/availability
    name: living_room_temperature_free_memory
    value_template: '{{ value_json.freeMemory }}'
    unit_of_measurement: "b"
  - platform: mqtt
    state_topic: home/devices/living_room_temperature/availability
    name: living_room_temperature_uptime
    value_template: '{{ value_json.uptime }}'
    unit_of_measurement: "ms"
  - platform: mqtt
    state_topic: home/devices/bedroom_temperature/availability
    name: bedroom_temperature_free_memory
    value_template: '{{ value_json.freeMemory }}'
    unit_of_measurement: "b"
  - platform: mqtt
    state_topic: home/devices/bedroom_temperature/availability
    name: bedroom_temperature_uptime
    value_template: '{{ value_json.uptime }}'
    unit_of_measurement: "ms"

binary_sensor:
  - platform: mqtt
    state_topic: home/devices/well_controller/availability
    name: well_controller_available
    value_template: '{{ value_json.available }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/furnaceTemperature/availability
    name: furnace_temperature_available
    value_template: '{{ value_json.available }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/motion_sensor_driveway_lower/availability
    name: motion_sensor_driveway_lower_available
    value_template: '{{ value_json.available }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/motion_sensor_driveway_upper/availability
    name: motion_sensor_driveway_upper_available
    value_template: '{{ value_json.available }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/living_room_temperature/availability
    name: living_room_temperature_available
    value_template: '{{ value_json.available }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/bedroom_temperature/availability
    name: bedroom_temperature_available
    value_template: '{{ value_json.available }}'
    payload_on: true
    payload_off: false

  - platform: mqtt
    state_topic: home/devices/well_controller/availability
    name: well_controller_restarted
    value_template: '{{ value_json.restarted }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/furnaceTemperature/availability
    name: furnace_temperature_restarted
    value_template: '{{ value_json.restarted }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/motion_sensor_driveway_lower/availability
    name: motion_sensor_driveway_lower_restarted
    value_template: '{{ value_json.restarted }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/motion_sensor_driveway_upper/availability
    name: motion_sensor_driveway_upper_restarted
    value_template: '{{ value_json.restarted }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/living_room_temperature/availability
    name: living_room_temperature_restarted
    value_template: '{{ value_json.restarted }}'
    payload_on: true
    payload_off: false
  - platform: mqtt
    state_topic: home/devices/bedroom_temperature/availability
    name: bedroom_temperature_restarted
    value_template: '{{ value_json.restarted }}'
    payload_on: true
    payload_off: false

  - platform: mqtt
    state_topic: home/sensors/motion/driveway_upper
    name: motion_sensor_driveway_upper
    payload_on: 1
    payload_off: 0
  - platform: mqtt
    state_topic: home/sensors/motion/driveway_lower
    name: motion_sensor_driveway_lower
    payload_on: 1
    payload_off: 0
  - platform: mqtt
    state_topic: "$SYS/broker/connection/hassbian.homeassistant_gateway/state"
    name: mosquitto_bridge_available
    payload_on: 1
    payload_off: 0
  - platform: ping
    host: !secret router_address
    name: network_available
  - platform: ping
    host: !secret desktop_address
    name: desktop_available
  - platform: ping
    host: google.com
    name: internet_available
  - platform: ping
    host: !secret gateway_address
    name: gateway_available
  - platform: command_line
    command: 'timeout 2 netcat localhost 8888 </dev/null && echo ON || echo OFF'
    name: ssh_tunnel_available

switch:
  - platform: mqtt
    name: well
    command_topic: home/switches/well/set
    state_topic: home/switches/well/state
    payload_on: 1
    payload_off: 0
  - platform: mqtt
    name: heating_pump
    command_topic: home/switches/heating_pump/set
    state_topic: home/switches/heating_pump/status
    payload_on: 1
    payload_off: 0
  - platform: mqtt
    name: light_driveway
    command_topic: home/switches/lights/driveway/set
    state_topic: home/switches/lights/driveway/state
    payload_on: 1
    payload_off: 0

input_select:
    light_driveway:
        name: Bejáró világítás
        options:
            - "auto"
            - "on"
            - "off"

influxdb:
  host: !secret influxdb_address
  port: 8086
  ssl: true
  verify_ssl: true
  username: !secret influxdb_username
  password: !secret influxdb_password
  database: !secret influxdb_database

# Text to speech
tts:
  platform: google

group: !include groups.yaml
automation: !include automations.yaml
