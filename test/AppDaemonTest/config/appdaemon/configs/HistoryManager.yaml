global_modules:
    - aggregator

test_history_manager:
    class: HistoryManager
    module: history
    entity: sensor.test_sensor
    max_interval:
        hours: 1

aggregated_value:
    class: AggregatedValue
    module: history
    dependencies: test_history_manager
    manager: test_history_manager
    target: sensor.test_sensor_sum
    default: 0
    interval:
        minutes: 3
    aggregator: sum

mean_value:
    class: AggregatedValue
    module: history
    global_dependencies:
        - aggregator
    dependencies: test_history_manager
    manager: test_history_manager
    target: sensor.test_sensor_mean
    default: 0
    interval:
        minutes: 2
    aggregator: mean

test_history_enabler:
    class: HistoryEnabler
    module: enabler
    dependencies: test_history_manager
    manager: test_history_manager
    interval:
        minutes: 5
    aggregator: sum
    min: 5
    max: 10
